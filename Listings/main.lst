C51 COMPILER V9.54   MAIN                                                                  10/19/2025 12:07:53 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: D:\keil_v5\C51\BIN\C51.EXE Users\main.c OPTIMIZE(8,SPEED) BROWSE INCDIR(.\Users;.\Driver) DEBUG OBJ
                    -ECTEXTEND PRINT(.\Listings\main.lst) OBJECT(.\Objects\main.obj)

line level    source

   1          /* 头文件包含区域 */
   2          #include "main.h"
   3          #include "keyInput.h"
   4          
   5          /* 变量声明区域 */
   6          lightStatus lightState; // 台灯状态变量
   7          unsigned char lightGrade[5] = {0, 25, 50, 75, 100};     // 台灯等级
   8          unsigned char pwmCount;         // PWM周期计数（0~99，累计100×10μs=1ms）
   9          
  10          /* 函数声明区域 */
  11          // 系统初始化函数
  12          void systemInit(void) {
  13   1              timer0Init();   // 初始化定时器0
*** WARNING C206 IN LINE 13 OF Users\main.c: 'timer0Init': missing function-prototype
  14   1              
  15   1              lightState = LAMP_CLOSE;        // 上电时默认关闭
  16   1              pwmCount = 0;   // PWM周期计数初始为 0
  17   1      }
  18          
  19          //// 台灯调节函数
  20          //void lampControl(void) {
  21          //      LED_MAIN = 0;   // 台灯引脚给 0 亮
  22          //      
  23          //}
  24          
  25          /* Main */
  26          void main() {           
  27   1              // 以下为台灯调节测试代码
  28   1              unsigned char keyNumber;
  29   1              
  30   1              systemInit();
  31   1      
  32   1              
  33   1              while(1) {
  34   2                      keyNumber = keyRead();
  35   2                      if(keyNumber == 1) {
  36   3                              lightState = LAMP_LOW;  // 弱亮
  37   3                      } else if(keyNumber == 2) {
  38   3                              lightState = LAMP_MEDIUM;       // 中亮
  39   3                      } else if(keyNumber == 3) {
  40   3                              lightState = LAMP_HIGHT;        // 高亮
  41   3                      } else if(keyNumber == 4) {
  42   3                              lightState = LAMP_HIGHTEST;     // 最亮
  43   3                      }
  44   2              }
  45   1      }
  46          
  47          // 定时器0中断服务函数，每10us中断一次
  48          void timer0_ISR(void) interrupt 1 {
  49   1          // 重装载初值，保证每次定时一致
  50   1          TH0 = (65536 - 9) / 256;  
  51   1          TL0 = (65536 - 9) % 256;  
  52   1          
  53   1              pwmCount++;
C51 COMPILER V9.54   MAIN                                                                  10/19/2025 12:07:53 PAGE 2   

  54   1          pwmCount %= 100;
  55   1              if(pwmCount < lightGrade[lightState]) {
  56   2                      LED_MAIN = 0;   // 台灯引脚给 0 亮
  57   2              } else {
  58   2                      LED_MAIN = 1;   // 台灯引脚给 1 灭
  59   2              }
  60   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    107    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      7    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  1 WARNING(S),  0 ERROR(S)
