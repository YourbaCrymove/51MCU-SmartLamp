C51 COMPILER V9.54   NIXIESTC89C52RC                                                       10/23/2025 17:56:48 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE NIXIESTC89C52RC
OBJECT MODULE PLACED IN .\Objects\nixieSTC89C52RC.obj
COMPILER INVOKED BY: D:\keil_v5\C51\BIN\C51.EXE Driver\nixieSTC89C52RC.c OPTIMIZE(8,SPEED) BROWSE INCDIR(.\Users;.\Drive
                    -r) DEBUG OBJECTEXTEND PRINT(.\Listings\nixieSTC89C52RC.lst) OBJECT(.\Objects\nixieSTC89C52RC.obj)

line level    source

   1          #include "nixieSTC89C52RC.h"
   2          #include <regx52.h>
   3          #include "delay.h"
   4          
   5          // 共阳极数码管段码表（0-9）
   6          // 段码顺序：dp g f e d c b a (P0.7-P0.0)
   7          unsigned char code nixieTable[] = {
   8              0x3f, 0x06, 0x5b, 0x4f, 0x66,               // 显示 0-4
   9              0x6d, 0x7d, 0x07, 0x7f, 0x6f,               // 显示 5-9
  10                  0x00
  11          };  
  12          
  13          // 位选数组：存储每个位置对应的CBA电平组合
  14          // 数组索引0-7对应位置1-8，每个元素的低3位分别对应C(P2_4)、B(P2_3)、A(P2_2)
  15          unsigned char code locationTable[] = {
  16              0x07, 0x06, 0x05, 0x04,             // 位置 1-4
  17              0x03, 0x02, 0x01, 0x00              // 位置 5-8
  18          };
  19          
  20          /**
  21           * @brief 数码管显示函数
  22           * @param location 数码管位置（1-8）
  23           * @param number 要显示的数字（0-9）
  24           * @param point 小数点（0表示不显示，1表示显示）
  25           */
  26          void nixieScan(unsigned char location, unsigned char number, unsigned char point) {   
  27   1              unsigned char pos;              // 数组索引变量
  28   1              
  29   1          // 校验位置范围
  30   1          if(location < 1 || location > 8) return;
  31   1          
  32   1          // 根据位置设置位选信号（通过74HC138译码器）
  33   1          pos = location - 1;  // 转换为数组索引
  34   1          P2_4 = (locationTable[pos] >> 2) & 0x01;  // 提取C位
  35   1          P2_3 = (locationTable[pos] >> 1) & 0x01;  // 提取B位
  36   1          P2_2 = locationTable[pos] & 0x01;         // 提取A位
  37   1          
  38   1          // 设置段选信号（通过P0口输出段码）
  39   1              if(point) {     // 判断是不是数码管的偶数位
  40   2                      P0 = nixieTable[number] | 0x80;         // 偶数位加上小数点
  41   2              } else {
  42   2                      P0 = nixieTable[number];                // 奇数位正常显示
  43   2              }
  44   1          
  45   1          
  46   1          // 静态显示数码管去掉下面两行代码
  47   1          // 短暂延时，维持显示
  48   1          delayMs(1);  // 约1ms延时，保证亮度
  49   1          
  50   1          // 消隐处理：关闭所有段，防止切换到下一个数码管时产生鬼影
  51   1          P0 = 0x00;  // 所有段置高电平（共阳极数码管熄灭）
  52   1      }


C51 COMPILER V9.54   NIXIESTC89C52RC                                                       10/23/2025 17:56:48 PAGE 2   

MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     70    ----
   CONSTANT SIZE    =     19    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
