# 智能台灯项目技术说明

## 一、项目核心-PWM

### LED 明明只有两种状态，为何单片机还能调出不同亮度？

**==具体原理==**

1. **LED 的物理特性**：

	LED 本身是二极管，只有 “导通发光” 和 “截止不发光” 两种状态，无法直接通过改变电压或电流的大小（在安全范围内）连续调节亮度（电流过大会烧毁，过小可能无法点亮）。

2. **PWM 技术的应用**：

	单片机通过快速切换 LED 的 “亮” 和 “灭” 状态（例如每秒切换数千次），控制 “亮” 的时间占比（即**占空比**）：

	- 占空比 = 亮的时间 / 一个周期的总时间
	- 当占空比为 100% 时，LED 一直亮，呈现 “强亮”；
	- 当占空比为 50% 时，LED 一半时间亮、一半时间灭，人眼因视觉暂留会感知为 “中等亮度”；
	- 当占空比为 10% 时，LED 亮的时间很短，人眼会感知为 “弱亮”（接近熄灭）。

3. **视觉暂留的作用**：

	人眼对快速变化的光信号会产生 “融合” 效果，只要切换频率高于人眼的分辨能力（通常高于 50Hz），就不会感觉到闪烁，而是将亮灭的平均效果感知为连续的亮度

**==总结==**

- LED 的 “强亮” 和 “弱亮” 并非物理上的亮度变化，而是通过 PWM 技术调节亮灭的时间占比，利用人眼的视觉暂留特性，形成的 “平均亮度” 感知。这是单片机控制 LED 亮度的核心方法

### 怎么实现PWM调节台灯亮度？

#### PWM实现方式选择

PWM 的本质是 “在固定周期内，精确控制高电平与低电平的时间占比”（即占空比）。要实现这一点，必须依赖**精确的时间度量**，而定时器的核心功能正是 “按预设时间间隔触发事件”（如中断），恰好满足 PWM 的两个关键需求：

1. **稳定的周期**：PWM 周期（如 10ms）需要严格固定（否则会出现闪烁或亮度跳变），定时器通过预设初值，能稳定输出固定间隔的中断（如每 10μs 触发一次），累积后形成固定周期。
2. **精确的占空比调节**：通过定时器中断计数，可精准控制 “高电平持续多少个时间单位”“低电平持续多少个时间单位”。例如，周期为 100 个单位时间时，若前 30 个单位输出高电平，后 70 个输出低电平，即可得到 30% 的占空比 —— 这种精准的时间分割必须依赖定时器的计数功能。

如果不用定时器，改用软件延时（如`delay()`函数），会因单片机执行其他代码（如主函数中的逻辑）导致延时时间不稳定，最终 PWM 周期和占空比偏差大，出现明显闪烁或亮度失控





### PWM 概念

- PWM全称为脉冲宽度调制，在具有惯性的系统中，可以通过对一系列脉冲的宽度进行调制，来等效获得所需要的模拟参量

- 它的核心思想是改变一个固定周期内**高电平**信号所占的时间比例（即占空比），而保持频率不变，从而等效地输出不同的平均电压或功率

### 相关术语

- **周期 (T)：** 一个完整脉冲（从“开”到“关”再回到“开”）所花费的时间
- **频率 (f)：**周期的倒数 (f = 1/T)，表示每秒内有多少个脉冲周期
- **脉冲宽度 (Ton)：**在一个周期内，信号处于“开”（高电平）状态的时间
- **占空比 (Duty Cycle)：**脉冲宽度与周期的比值（通常用百分比表示）
	- `占空比 = (Ton / T) * 100%`

- **举例：**

	- 0% 占空比：信号始终关闭（低电平），平均电压为 0。
	- 50% 占空比：信号在一个周期内一半时间开，一半时间关，平均电压是最大电压的一半

	- 100% 占空比：信号始终开启（高电平），平均电压等于最大电压